{% extends 'base.html' %}

{% block title %}Запрос замены №{{ replacement_request.id }}{% endblock %}

{% block content %}
<h2>Запрос замены устройства №{{ replacement_request.id }}</h2>

<section style="background: #f9faff; padding: 20px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
  <h3>Детали заявки</h3>
  <p><strong>Устройство:</strong> {{ replacement_request.service_request.device.name }} (Серийный номер: {{ replacement_request.service_request.device.serial_number }})</p>
  <p><strong>Корпус:</strong> {{ replacement_request.service_request.device.cabinet.building }}, кабинет {{ replacement_request.service_request.device.cabinet.number }}</p>
  <p><strong>Описание проблемы:</strong> {{ replacement_request.service_request.description }}</p>
  <p><strong>Дата создания заявки:</strong> {{ replacement_request.service_request.created_at|date:"d.m.Y H:i" }}</p>

  {% if not replacement_request.admin_approved %}
    <p style="margin-top: 20px; font-weight: 600; color: #d9534f;">
      Запрос отправлен администратору на одобрение замены оборудования. Пожалуйста, дождитесь решения.
    </p>
  {% else %}
    <p style="margin-top: 20px; font-weight: 600; color: #5cb85c;">
      Запрос одобрен администратором. Заполните отчёт о замене устройства и закройте заявку.
    </p>
  {% endif %}
</section>

{% if replacement_request.admin_approved %}
  <hr style="margin: 30px 0; border: none; border-top: 1px solid #ccc;">

  <section style="background: #f9faff; padding: 20px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
    <h3>Отчёт о замене устройства</h3>

    <form method="post" style="max-width: 600px;">
      {% csrf_token %}
      {{ form.as_p }}
      <button type="submit" class="btn" style="
        background-color: #007acc;
        color: white;
        padding: 12px 24px;
        border-radius: 6px;
        font-weight: 600;
        font-size: 16px;
        border: none;
        cursor: pointer;
        box-shadow: 0 4px 8px rgba(0,122,204,0.2);
        transition: background-color 0.3s ease;
      ">
        Подтвердить замену и закрыть заявку
      </button>
    </form>
  </section>
{% endif %}

<p style="margin-top: 20px;">
  <a href="{% url 'engineer_dashboard' %}" style="
    color: #007acc;
    text-decoration: none;
    font-weight: 600;
  ">← Назад к панели инженера</a>
</p>
{% endblock %}
